<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Accueil des tâches</title>
        <link rel='shortcut icon' type='image/x-icon' href='../images/favicon.png' />
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css">
        <link rel="stylesheet" href="../external-scripts/materialize.min.css">	
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>

        <!-- TODO: Add SDKs for Firebase products that you want to use
             https://firebase.google.com/docs/web/setup#available-libraries -->
        <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-analytics.js"></script>
        <!-- Add Firebase products that you want to use -->
        <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-functions.js"></script>


        <script>
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            var firebaseConfig = {
                apiKey: "AIzaSyCfR5vVvnfqNaxTDOcHRFc7Ooo5jQiR_ds",
                authDomain: "manager-fde36.firebaseapp.com",
                databaseURL: "https://manager-fde36.firebaseio.com",
                projectId: "manager-fde36",
                storageBucket: "manager-fde36.appspot.com",
                messagingSenderId: "1067864958809",
                appId: "1:1067864958809:web:2fe28fed98cdd287008e48",
                measurementId: "G-1E861N60ZL"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            firebase.analytics();
        </script>

    </head>
    
    <body>
             
        <!-- side nav content -->
        <ul id="slide-out" class="sidenav">
            <li>
                <div class="user-view">

                    <div class="background" style="background-color: #69a9fc;
                    background-image: linear-gradient(62deg, #4040fc 0%, #69a9fc 100%);">
                    </div>
                    <img id="user_image" class="circle left" src="../images/default_user_image.png" alt="">
                    <div id="user_name" class="white-text name leftm75"></div>
                    <div id="user_email" class="white-text email leftm75"></div>
                </div>
            </li>

            <li><a href="my_clients.html"><i class="fas fa-users fa-lg"></i>Mes clients</a></li>
            <li><div class="divider"></div></li>
            <li><a href="javascript:logOutUser();"><i class="fas fa-sign-out-alt fa-lg"></i>Déconnexion</a></li>
        </ul>

        <div style="padding: 10px; position: fixed;">
            <a href="#" data-target="slide-out" class="sidenav-trigger btn-floating btn-large waves-effect waves-light black">
            <i class="material-icons">menu</i>
            </a>
        </div>

        <div class="container">

            <!-- Page content -->
            <div id="invoice_form" class="row">
                <a href="my_clients.html">
                    <div class="col s12 clickable-section">
                        <div class="card white">
                            <div class="card-image" style="background-color: #e54f48;
                        background-image: linear-gradient(19deg, #c1332c 0%, #DDD6F3 100%);
                        height: 30px;">
                            </div>
                            <div class="card-content black-text">
                                <span class="card-title"><i class="fas fa-users fa-med"></i>&ensp; Mes Clients</span>
                                <p>
                                    Gérer les dossiers de mes clients
                                </p>
                            </div>
                        </div>
                    </div>
                </a>

                <a href="my_items.html">
                    <div class="col s12 clickable-section">
                        <div class="card white">
                            <div class="card-image" style="background-color: #8EC5FC;
                        background-image: linear-gradient(62deg, #8EC5FC 0%, #E0C3FC 100%);
                        height: 30px;">
                            </div>
                            <div class="card-content black-text">
                                <span class="card-title"><i class="fas fa-shopping-bag fa-med"></i>&ensp; Mes Articles</span>
                                <p>
                                    Gérer les articles à facturer
                                </p>
                            </div>
                        </div>
                    </div>
                </a>
                <div style="width: available;">
                    <div class="col s12">
                        <div id='modal1' class='modal modal-fixed-footer'>
                            <div class="row center-align">
                                <div class="row">
                                    <div class="input-field col s12">
                                        <div id="select_clients"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="width: available;">
                    <div class="col s12">
                        <div id='modal2' class='modal modal-fixed-footer'>
                            <div class="row center-align">
                                <div class="row">
                                    <div class="input-field col s12">
                                        <div id="select_clients2"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </body>

    <!-- Full screen preloader -->
    <div class="main-loader">
        <div class="preloader-wrapper big active">
            <div class="spinner-layer spinner-blue-only">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="../scripts/home.js"></script>
    <script src="../external-scripts/materialize.min.js"></script>

    <script>
        triggerFullScreenPreloader();
        document.addEventListener('DOMContentLoaded', function() {
            var elems = document.querySelectorAll('select');
            var instances = M.FormSelect.init(elems);
        });

        document.addEventListener('DOMContentLoaded', function() {
            var elems = document.querySelectorAll('.collapsible');
            var instances = M.Collapsible.init(elems);
        });

        document.addEventListener('DOMContentLoaded', function() {
            var elems = document.querySelectorAll('.sidenav');
            var instances = M.Sidenav.init(elems, {});
        });

        document.addEventListener('DOMContentLoaded', function() {
            var elems = document.querySelectorAll('.modal');
            var instances = M.Modal.init(elems);
        });

        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
                checkUser();
                retrieveAllRemainingTasksFromFirestore();
                retrieveClientNamesFromFirestore();

                if (user.photoURL) {
                    document.getElementById("user_image").src = user.photoURL;
                }
                document.getElementById("user_name").innerText = user.displayName;
                document.getElementById("user_email").innerText = user.email;
                triggerFullScreenPreloader();
            } else {
                window.location = "../index.html";
            }
        });

        function logOutUser() {
            firebase.auth().signOut().then(function() {
                document.location.href = "https://www.google.com/accounts/Logout?continue=https://appengine.google.com/_ah/logout?continue=https://faisalhotak.github.io/Manager/"
            }).catch(function(error) {
                console.log(error);
            });
        }
    </script>
</html>